<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TanaCoin Wallet</title>
    <link rel="stylesheet" href="style.css">
    <style>
        Body{
            background: #eaffff97;
        }
        #{
    font-family: Arial, sans-serif;
    background-color: #eaffff97;
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    text-shadow: 3px 4px 8px rgba(0, 0, 0, 0.3); 
    Text-align:center;
    overflow: auto;     
}

.wallet-container {
    background-color: #eaffff97;
    justify-content: center;
    
    padding: 0px;
    border-radius: 10px;
    text-align: center;
     border-top: 5px solid green;
    
    width: 100%;
    overflow: auto;     
}

.balance-container {
    margin-top: 20px;
    
   background: #66ff2b; 
    Border-radius:10px;
    border-top: 7px solid red;
    
    font-size: 20px;
}

.menu-container {
    margin-top: 20px;
    display: flex;
            justify-content: space-between;
            margin-top: 20px;
       box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);    
}



.hidden {
    display: none;
}

form label {
    display: block;
    margin: 10px 0 5px;
}

form input {
    width: 80%;
    padding: 10px;
    margin-bottom: 10px;
    Border-radius:10px;
    
}

.menu-container{
    margin-top: 2px;
    margin-top: 2px;
    display: flex;
            justify-content: space-between;
            margin-top: 2px;

}

button{
    background-color: #3498db;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.70);
}

 .balance-container {
            margin-top: 20px;
            font-size: 18px;
       border-bottom: 3px solid blue; 
          box-shadow: 0 4px 10px rgba(20, 0, 0, 0.75);
        }

        .balance-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #e9e9e9;
         box-shadow: 0 4px 10px rgba(0, 0, 0, 0.89);  
         border-bottom: 3px solid blue;     
            padding: 10px;
            border-radius: 8px;
        
        }

        .balance-display img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
       box-shadow: 0 4px 10px rgba(0, 0, 0, 0.70);    
        }

        .balance-display .tnc-amount {
            color: green;
            Font-weight: bold;
            Font-size: 17px;
        }

        .balance-display .dollar-amount {
            color: red;
            Font-weight: bold;
            Font-size: 17px;
        }
        
         .menu-item {
            text-align: center;
            
        }

        .menu-item img {
            width: 50px;
            height: 50px;
            Border-radius: 50%;
            
            display: block;
            margin: 0 auto 5px;
            
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.70);
        }

        .menu-item button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.70);
        }
       .menu-item:hover {
         background: #1100ff; 
         Border-radius: 10px;
       }
         .menu-item button:hover{
         background: #1100ff; 
         Border-radius: 10px;  
         } 
        .dollar{
            Font-weight: bold;
            Font-size: 30px;
        } 
         .container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    background-color: #ffaaf46c;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

h1 {
    text-align: center;
    color: #0066cc;
    font-size: 13px;
    margin-bottom: 20px;
    font-weight: bold;
}

.description {
    font-size: 10px;
    color: #555;
    font-weight: bold;
}

.highlight {
    color: #ff8800;
    font-weight: bold;
}
.pay{
    font-size: 20px;
            color: #27ae60;
            text-transform: capitalize;
            border: 2px dashed #2ecc71;
            padding: 5px;
            Font-weight: bold;
            Text-align: center;
            border-radius: 10px;
        }
P{
    Font-weight: bold;
    
}

.amount-container {
    display: flex;
    align-items: center;
}

#amount {
    width: 100px;
    padding: 10px;
    margin-right: 10px;
    border-radius: 10px;
    border: 2px solid #333;
}

#coinEquivalent {
    font-size: 19px;
    font-weight: bold;
    color: #4A90E2;
}
#walletAddressDisplay{
    Font-weight:  bold;
    Font-size: 11px;
}
.TNC{
    Font-weight: bold;
    Font-size: 20px;
    Color: red;
}
.pay{ 

    background: repeating-linear-gradient(
                -45deg,
                #3498db,
                #3498db 10px,
                #2980b9 10px,
                #2980b9 20px
            );
            color: white;
            padding: 10px;
            border-radius: 10px;
     
}

#walletAddressDisplay{
    Font-weight: bold;
    Font-size: 9px;
}
    </style>
</head>
<body>
    <i id="TanaCoinPrice" style="display: none;">$5.00</i>

    <div class="wallet-container">
                       <h2 class="pay"><i style="color:red;">üïäÔ∏èTana</i><i style="color:green;">Coin</i> Wallet        <span id="firstNameDisplay"></span> <span id="lastNameDisplay"></span></h2>

                            
        <!-- Display user balance -->
        <div class="balance-container">
            <h3>Your Balance</h3>
            <p class ="dollar" id="dollar_total">$0.00</p>
            
        </div>
        
       <p> <section>
            <div class="balance-display">
                <img src="dove.png" alt="TanaCoin">
                <div>
                    <span class="TNC">TN<i style="color:green;">C</i></span> <span class="tnc-amount" id="userBalance"> 0.00000</span>
                    <span class="dollar-amount" id="dollar_totalone">$0.00</span>
                </div>
            </div>            
        </section></p>

        <!-- Send/Receive Menu -->
       <p> <section>
           <p><button onclick="location.href='chenge.html'">Chenge TNC & Widrowal</button>
</p>      
        <div class="menu-container">
            
            <div class="menu-item">
         <img src="send.png" alt="Send Icon">   
            <button id="sendBtn">Sending</button></div>
            <div>
              <div class="menu-item">
         <img src="receive.png" alt="Send Icon">  
            <button id="receiveBtn">Receiving</button>
        </div>
        </section></p>

        <!-- Send TanaCoin Form -->
        <div id="sendContainer" class="hidden">
    <h3>Send <i style="color:red;">üïäÔ∏èTana</i><i style="color:green;">Coin</i></h3>
    <p>Ally TNC <i style="color:red;">üïäÔ∏èTana</i><i style="color:green;">Coin</i> Wallet address you can send this Coin</p>
    <form id="sendForm">
        <label for="walletAddress">TNC Wallet Address:</label>
        <input type="text" id="walletAddress" placeholder="Ally TanaCoin Wallet Address" required>

        <label for="amount">TNC Amount (in dollars):</label>
        <div class="amount-container">
            <input type="number" id="amount" placeholder="$0.00" required>
            <span id="coinEquivalent">TNC: 0.00000</span>
        </div>

        <label for="password">Your Login Password:</label>
        <input type="password" id="password" placeholder="Your password" required>

        <button type="submit">Submit</button>
    </form>
</div>

        <!-- Receive Wallet Address -->
        <div id="receiveContainer" class="hidden">
            <h3>Copy Your Wallet Address</h3>
            <p id="walletAddressDisplay"></p>
            <button id="copyBtn">Copy Wallet Address</button>
            <p style="color: blue;" id="copyMessage"></p>
        </div>

        <!-- Transaction History -->
       <section>
           <p>
        <div class="menu-container">
    <div class="menu-item">
        <img src="history1.png" alt="History Receive Icon">
        <button id="historyReceiveBtn">History Receive</button>
    </div>
    
    <div class="menu-item">
        <img src="history2.png" alt="History Send Icon">
        <button id="historySendBtn">History Sending</button>
    </div>
</div>
</section></p>
    

        <!-- History Containers -->
        <div id="historyReceiveContainer" class="hidden">
            <h3>Received TanaCoin History</h3>
            <div id="receivedHistoryList"></div>
        </div>

        <div id="historySendContainer" class="hidden">
            <h3>Sent TanaCoin History</h3>
            <div id="sentHistoryList"></div> 
        </div>
         <div class="container">
        <h1> <i style="color:red;">üïäÔ∏èTana</i><i style="color:green;">Coin</i> (TNC) Information</h1>
        <p class="description">
            target price for<span class="highlight">TanaCoin (TNC) </span> is $5, but it can go higher or lower depending on market conditions. As more people mine and use TNC coins, its value is expected to rise significantly, much like <span class="highlight">Bitcoin</span>. 
            y inviting others to join the TNC mining community, you can help grow the network and increase the potential earnings for everyone involved.

Take advantage of this opportunity‚Äîmine TNC coins today and watch your earnings grow with the network!!
        </p>   
            <img src="pm.png" style="width: 100%; height: 50%;">
    </div>
    </div>
<script>
    // Samun maballin da akwatinan da suka dace
const sendBtn = document.getElementById('sendBtn');
const receiveBtn = document.getElementById('receiveBtn');
const historyReceiveBtn = document.getElementById('historyReceiveBtn');
const historySendBtn = document.getElementById('historySendBtn');

const sendContainer = document.getElementById('sendContainer');
const receiveContainer = document.getElementById('receiveContainer');
const historyReceiveContainer = document.getElementById('historyReceiveContainer');
const historySendContainer = document.getElementById('historySendContainer');
const receivedHistoryList = document.getElementById('receivedHistoryList');
const sentHistoryList = document.getElementById('sentHistoryList');

// Aikin boye dukkan akwatinan
function hideAllContainers() {
    sendContainer.classList.add('hidden');
    receiveContainer.classList.add('hidden');
    historyReceiveContainer.classList.add('hidden');
    historySendContainer.classList.add('hidden');
}

function checkTransactionHistory() {
    if (!receivedHistoryList.innerHTML.trim()) {
        receivedHistoryList.innerHTML = '<p style="color:red;">Not Transactions History</p>';
    }
    if (!sentHistoryList.innerHTML.trim()) {
        sentHistoryList.innerHTML = '<p style="color:red;">Not Transactions History</p>';
    }
}

sendBtn.addEventListener('click', () => {
    if (sendContainer.classList.contains('hidden')) {
        hideAllContainers();
        sendContainer.classList.remove('hidden');
    } else {
        sendContainer.classList.add('hidden');
    }
});

receiveBtn.addEventListener('click', () => {
    if (receiveContainer.classList.contains('hidden')) {
        hideAllContainers();
        receiveContainer.classList.remove('hidden');
    } else {
        receiveContainer.classList.add('hidden');
    }
});

historyReceiveBtn.addEventListener('click', () => {
    if (historyReceiveContainer.classList.contains('hidden')) {
        hideAllContainers();
        historyReceiveContainer.classList.remove('hidden');
        checkTransactionHistory();
    } else {
        historyReceiveContainer.classList.add('hidden');
    }
});

historySendBtn.addEventListener('click', () => {
    if (historySendContainer.classList.contains('hidden')) {
        hideAllContainers();
        historySendContainer.classList.remove('hidden');
        checkTransactionHistory();
    } else {
        historySendContainer.classList.add('hidden');
    }
});
</script>
        <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getDatabase, ref, get, set, update, push } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";
   import { getAuth, onAuthStateChanged, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

    // Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyBZl5lT_PEvGZh034gstErFfjEaMFsFzKY",
        authDomain: "tanacoin-mine.firebaseapp.com",
        databaseURL: "https://tanacoin-mine-default-rtdb.firebaseio.com/",
        projectId: "tanacoin-mine",
        storageBucket: "tanacoin-mine.appspot.com",
        messagingSenderId: "550307127686",
        appId: "1:550307127686:web:a7fb30e74aefebf3280c07",
        measurementId: "G-596X16VEGX"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const auth = getAuth();

    // DOM Elements for displaying names
    const firstNameDisplay = document.getElementById('firstNameDisplay');
    const lastNameDisplay = document.getElementById('lastNameDisplay');

    // Load user information
    function loadUserInfo(uid) {
        const userRef = ref(db, `users/${uid}`);
        get(userRef).then(snapshot => {
            const data = snapshot.val();
            if (data) {
                firstNameDisplay.textContent = data.firstName;
                lastNameDisplay.textContent = data.lastName;
            }
        }).catch(console.error);
    }

    // Fetch user data and update balance
    async function getUserData(uid) {
        const userRef = ref(db, `users/${uid}`);
        const userSnap = await get(userRef);
        if (userSnap.exists()) {
            const userData = userSnap.val();
            const walletAddress = userData.walletAddress || "Not available";
            const userBalance = parseFloat(userData.userBalance) || 0;

            const pricePerTNC = parseFloat(document.getElementById('TanaCoinPrice').textContent) || 5.00;
            const dollarTotal = (userBalance * pricePerTNC).toFixed(2);

            document.getElementById('userBalance').textContent = `${userBalance.toFixed(5)} `;
            document.getElementById('dollar_total').textContent = `$${dollarTotal}`;
            document.getElementById('dollar_totalone').textContent = `$${dollarTotal}`;
            document.getElementById('walletAddressDisplay').textContent = walletAddress;
        }
    }

    // Fetch recipient's name using wallet address
    async function getRecipientName(walletAddress) {
        const recipientRef = ref(db, `users/${walletAddress}`);
        const recipientSnap = await get(recipientRef);
        if (recipientSnap.exists()) {
            const recipientData = recipientSnap.val();
            return `${recipientData.firstName} ${recipientData.lastName}`;
        } else {
            throw new Error("Recipient not found!");
        }
    }

    const TanaCoinPrice = parseFloat(document.getElementById('TanaCoinPrice').textContent) || 5.00;
    
    

    // Calculate TanaCoin equivalent    
    document.getElementById('amount').addEventListener('input', function () {
        const amountInDollars = parseFloat(document.getElementById('amount').value);
        const equivalentTNC = isNaN(amountInDollars) || amountInDollars <= 0 ? 0 : (amountInDollars / TanaCoinPrice).toFixed(5);
        document.getElementById('coinEquivalent').textContent = `TNC: ${equivalentTNC}`;
    });

    // Handle TanaCoin Transfer
    document.getElementById('sendForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const walletAddress = document.getElementById('walletAddress').value;
        const amount = parseFloat(document.getElementById('amount').value);
        const password = document.getElementById('password').value;

        const user = auth.currentUser;
        if (!user) {
            alert("User not logged in!");
            return;
        }

        try {
            // Verify password using Firebase Authentication
            await signInWithEmailAndPassword(auth, user.email, password);

            // Fetch user data
            const senderRef = ref(db, `users/${user.uid}`);
            const senderSnap = await get(senderRef);
            if (!senderSnap.exists()) throw new Error("Sender data not found!");
            
            const senderData = senderSnap.val();
            const amountInTNC = amount / TanaCoinPrice;

            if (senderData.userBalance < amountInTNC) {
                alert("Insufficient balance!");
                return;
            }

            // Fetch recipient data
            const recipientRef = ref(db, `users/${walletAddress}`);
            const recipientSnap = await get(recipientRef);
            if (!recipientSnap.exists()) {
                alert("Recipient not found!");
                return;
            }

            const recipientData = recipientSnap.val();
            const recipientName = `${recipientData.firstName} ${recipientData.lastName}`;
            const confirmSend = confirm(`Are you sure you want to send ${amountInTNC.toFixed(5)} TNC to ${recipientName} (${walletAddress})?`);
            if (!confirmSend) return;

            // Update balances
            const newSenderBalance = senderData.userBalance - amountInTNC;
            const newRecipientBalance = (recipientData.userBalance || 0) + amountInTNC;

            await update(senderRef, { userBalance: newSenderBalance });
            await update(recipientRef, { userBalance: newRecipientBalance });

            alert("Transaction successful!");
        } catch (error) {
            console.error("Transaction error:", error);
            alert("Password verification failed or transaction error!");
        }
    });

    // Copy wallet address
    document.getElementById('copyBtn').addEventListener('click', () => {
        const walletAddress = document.getElementById('walletAddressDisplay').textContent;
        navigator.clipboard.writeText(walletAddress).then(() => {
            document.getElementById('copyMessage').textContent = "Copy Your Wallet Address successfully!";
        });
    });

    // Transaction history
    async function addToSendHistory(senderId, recipientAddress, amount, recipientName) {
        const sendHistoryRef = ref(db, `sendHistory/${senderId}`);
        await push(sendHistoryRef, {
            recipient: recipientAddress,
            amount,
            recipientName,
            timestamp: new Date().toISOString()
        });
    }

    async function addToReceivedHistory(recipientAddress, senderId, amount, senderName) {
        const receivedHistoryRef = ref(db, `receivedHistory/${recipientAddress}`);
        await push(receivedHistoryRef, {
            sender: senderId,
            amount,
            senderName,
            timestamp: new Date().toISOString()
        });
    }

    async function getSendHistory(uid) {
        const sendHistoryRef = ref(db, `sendHistory/${uid}`);
        const snapshot = await get(sendHistoryRef);
        if (snapshot.exists()) {
            const history = snapshot.val();
            const sendHistoryList = document.getElementById('sentHistoryList');
            sendHistoryList.innerHTML = "";
            for (const key in history) {
                const { recipient, amount, recipientName, timestamp } = history[key];
                const historyItem = document.createElement('div');
                historyItem.textContent = `Sent ${amount} TNC to ${recipientName} (${recipient}) on ${timestamp}`;
                sendHistoryList.appendChild(historyItem);
            }
        }
    }

    async function getReceivedHistory(walletAddress) {
        const receivedHistoryRef = ref(db, `receivedHistory/${walletAddress}`);
        const snapshot = await get(receivedHistoryRef);
        if (snapshot.exists()) {
            const history = snapshot.val();
            const receivedHistoryList = document.getElementById('receivedHistoryList');
            receivedHistoryList.innerHTML = "";
            for (const key in history) {
                const { sender, amount, senderName, timestamp } = history[key];
                const historyItem = document.createElement('div');
                historyItem.textContent = `Received ${amount} TNC from ${senderName} (${sender}) on ${timestamp}`;
                receivedHistoryList.appendChild(historyItem);
            }
        }
    }
onAuthStateChanged(auth, (user) => {
        if (user) {
            loadUserInfo(user.uid);
            getSendHistory(user.uid);
            getUserData(user.uid);
        } else {
            alert("No user logged in. Please log in first.");
        }
    });
    
</script>
</body>
</html>
